<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>–ê–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü—ñ—è —Ä–æ–±–æ—Ç–∏ –∑ Excel –∑–∞ –¥–æ–ø–æ–º–æ–≥–æ—é Python —Ç–∞ win32com.client</title>

  <!-- Default Highlight.js CSS -->
  <link id="highlight-css" rel="stylesheet"
    href="../highlight/styles/atom-one-dark.css">
  <script src="../highlight/highlight.min.js"></script>
  <script src="../highlight/codeBlock.js"></script>
  <link rel="stylesheet" href="../assets/css/mystyle.css">
</head>

<body class="light"> <!-- Default to light theme -->

  <nav class="global">
    <a href="../index.html">Home</a>
    <a href="oracledb.html">–ú–æ–¥—É–ª—å python-oracledb –¥–ª—è —Ä–æ–±–æ—Ç–∏ –∑ –±–¥ Oracle</a>
    <a href="pywin32_excel.html">–ê–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü—ñ—è —Ä–æ–±–æ—Ç–∏ –∑ Excel –∑–∞ –¥–æ–ø–æ–º–æ–≥–æ—é Python —Ç–∞ win32com.client</a>
    <a href="pywin32_outlook.html">–ú–æ–¥—É–ª—å pywin32 –¥–ª—è —Ä–æ–±–æ—Ç–∏ –∑ Outlook</a>
  </nav>

  <nav class="local">
    <a href="#1">1. –ü—ñ–¥–≥–æ—Ç–æ–≤–∫–∞ —Å–µ—Ä–µ–¥–æ–≤–∏—â–∞</a>
    <a href="#2">2. –°—Ç–≤–æ—Ä–µ–Ω–Ω—è —Ç–∞ —Ä–µ–¥–∞–≥—É–≤–∞–Ω–Ω—è Excel-—Ñ–∞–π–ª—É</a>
    <div class="submenu">
      <a href="#2.1">2.1 –ü–µ—Ä–µ–≤—ñ—Ä–∫–∞ —ñ—Å–Ω—É–≤–∞–Ω–Ω—è —Ñ–∞–π–ª—É —Ç–∞ –π–æ–≥–æ –≤–∏–¥–∞–ª–µ–Ω–Ω—è</a>
      <a href="#2.2">2.2 –°—Ç–≤–æ—Ä–µ–Ω–Ω—è, –∑–±–µ—Ä–µ–∂–µ–Ω–Ω—è —Ñ–∞–π–ª—É —Ç–∞ –∑–∞–∫—Ä–∏—Ç—Ç—è</a>
      <a href="#2.3">2.3 –î–æ–¥–∞–≤–∞–Ω–Ω—è —Ç–∞ –ø–µ—Ä–µ–π–º–µ–Ω—É–≤–∞–Ω–Ω—è –∞—Ä–∫—É—à—ñ–≤</a>
      <a href="#2.4">2.4 –í—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—è –∞–∫—Ç–∏–≤–Ω–æ–≥–æ –∞—Ä–∫—É—à–∞</a>
      <a href="#2.5">2.5 –ü–µ—Ä–µ–ª—ñ–∫ –≤—Å—ñ—Ö –∞—Ä–∫—É—à—ñ–≤</a>
      <a href="#2.6">2.6 –í–∏–¥–∞–ª–µ–Ω–Ω—è –∞—Ä–∫—É—à–∞ –∑–∞ —ñ–º'—è–º</a>
      <a href="#2.7">2.7 –ó–∞–ø–∏—Å –¥–∞–Ω–∏—Ö —É –∫–ª—ñ—Ç–∏–Ω–∫–∏</a>
      <a href="#2.8">2.8 –§–æ—Ä–º–∞—Ç—É–≤–∞–Ω–Ω—è –∫–ª—ñ—Ç–∏–Ω–æ–∫</a>
      <a href="#2.8">2.8 –§–æ—Ä–º–∞—Ç—É–≤–∞–Ω–Ω—è –∫–ª—ñ—Ç–∏–Ω–æ–∫</a>
    </div>
    <a href="#3">3. –†–æ–±–æ—Ç–∞ –∑—ñ –∑–≤–µ–¥–µ–Ω–∏–º–∏ —Ç–∞–±–ª–∏—Ü—è–º–∏</a>
    <div class="submenu">
      <a href="#3.1">3.1 –°—Ç–≤–æ—Ä–µ–Ω–Ω—è –ø—Ä–æ—Å—Ç–æ—ó –∑–≤–µ–¥–µ–Ω–æ—ó —Ç–∞–±–ª–∏—Ü—ñ</a>
      <a href="#3.2">3.2 –°—Ç–≤–æ—Ä–µ–Ω–Ω—è —Å–∫–ª–∞–¥–Ω–æ—ó –∑–≤–µ–¥–µ–Ω–æ—ó —Ç–∞–±–ª–∏—Ü—ñ</a>
      <a href="#3.3">3.3 –°—Ç–≤–æ—Ä–µ–Ω–Ω—è —Å–∫–ª–∞–¥–Ω–æ—ó –∑–≤–µ–¥–µ–Ω–æ—ó —Ç–∞–±–ª–∏—Ü—ñ 2</a>
    </div>
  </nav>



  <!-- CSS Switcher -->
  <label for="theme-switcher">Theme:</label>
  <select id="theme-switcher">
    <option value="light" selected>Light</option>
    <option value="warm">Warm</option>
    <option value="cold">Cold</option>
  </select>

  <!-- Code Theme Switcher -->
  <label for="code-theme-switcher">Code theme:</label>
  <select id="code-theme-switcher">
    <option value="default">Default</option>
    <option value="atom-one-dark" selected>Atom One Dark</option>
    <option value="1c-light">1C Light</option>
    <option value="1c-light.min">1C Light.Min</option>
    <option value="a11y-dark">A11Y Dark</option>
    <option value="a11y-dark.min">A11Y Dark.Min</option>
    <option value="a11y-light">A11Y Light</option>
    <option value="a11y-light.min">A11Y Light.Min</option>
    <option value="agate">Agate</option>
    <option value="agate.min">Agate.Min</option>
    <option value="an-old-hope">An Old Hope</option>
    <option value="an-old-hope.min">An Old Hope.Min</option>
    <option value="androidstudio">Androidstudio</option>
    <option value="androidstudio.min">Androidstudio.Min</option>
    <option value="arduino-light">Arduino Light</option>
    <option value="arduino-light.min">Arduino Light.Min</option>
    <option value="arta">Arta</option>
    <option value="arta.min">Arta.Min</option>
    <option value="ascetic">Ascetic</option>
    <option value="ascetic.min">Ascetic.Min</option>
    <option value="atom-one-dark-reasonable">Atom One Dark Reasonable</option>
    <option value="atom-one-dark-reasonable.min">Atom One Dark Reasonable.Min</option>
    <option value="atom-one-dark.min">Atom One Dark.Min</option>
    <option value="atom-one-light">Atom One Light</option>
    <option value="atom-one-light.min">Atom One Light.Min</option>
    <option value="brown-paper">Brown Paper</option>
    <option value="brown-paper.min">Brown Paper.Min</option>
    <option value="codepen-embed">Codepen Embed</option>
    <option value="codepen-embed.min">Codepen Embed.Min</option>
    <option value="color-brewer">Color Brewer</option>
    <option value="color-brewer.min">Color Brewer.Min</option>
    <option value="dark">Dark</option>
    <option value="dark.min">Dark.Min</option>
    <option value="default.min">Default.Min</option>
    <option value="devibeans">Devibeans</option>
    <option value="devibeans.min">Devibeans.Min</option>
    <option value="docco">Docco</option>
    <option value="docco.min">Docco.Min</option>
    <option value="far">Far</option>
    <option value="far.min">Far.Min</option>
    <option value="felipec">Felipec</option>
    <option value="felipec.min">Felipec.Min</option>
    <option value="foundation">Foundation</option>
    <option value="foundation.min">Foundation.Min</option>
    <option value="github-dark-dimmed">Github Dark Dimmed</option>
    <option value="github-dark-dimmed.min">Github Dark Dimmed.Min</option>
    <option value="github-dark">Github Dark</option>
    <option value="github-dark.min">Github Dark.Min</option>
    <option value="github">Github</option>
    <option value="github.min">Github.Min</option>
    <option value="gml">Gml</option>
    <option value="gml.min">Gml.Min</option>
    <option value="googlecode">Googlecode</option>
    <option value="googlecode.min">Googlecode.Min</option>
    <option value="gradient-dark">Gradient Dark</option>
    <option value="gradient-dark.min">Gradient Dark.Min</option>
    <option value="gradient-light">Gradient Light</option>
    <option value="gradient-light.min">Gradient Light.Min</option>
    <option value="grayscale">Grayscale</option>
    <option value="grayscale.min">Grayscale.Min</option>
    <option value="hybrid">Hybrid</option>
    <option value="hybrid.min">Hybrid.Min</option>
    <option value="idea">Idea</option>
    <option value="idea.min">Idea.Min</option>
    <option value="intellij-light">Intellij Light</option>
    <option value="intellij-light.min">Intellij Light.Min</option>
    <option value="ir-black">Ir Black</option>
    <option value="ir-black.min">Ir Black.Min</option>
    <option value="isbl-editor-dark">Isbl Editor Dark</option>
    <option value="isbl-editor-dark.min">Isbl Editor Dark.Min</option>
    <option value="isbl-editor-light">Isbl Editor Light</option>
    <option value="isbl-editor-light.min">Isbl Editor Light.Min</option>
    <option value="kimbie-dark">Kimbie Dark</option>
    <option value="kimbie-dark.min">Kimbie Dark.Min</option>
    <option value="kimbie-light">Kimbie Light</option>
    <option value="kimbie-light.min">Kimbie Light.Min</option>
    <option value="lightfair">Lightfair</option>
    <option value="lightfair.min">Lightfair.Min</option>
    <option value="lioshi">Lioshi</option>
    <option value="lioshi.min">Lioshi.Min</option>
    <option value="magula">Magula</option>
    <option value="magula.min">Magula.Min</option>
    <option value="mono-blue">Mono Blue</option>
    <option value="mono-blue.min">Mono Blue.Min</option>
    <option value="monokai-sublime">Monokai Sublime</option>
    <option value="monokai-sublime.min">Monokai Sublime.Min</option>
    <option value="monokai">Monokai</option>
    <option value="monokai.min">Monokai.Min</option>
    <option value="night-owl">Night Owl</option>
    <option value="night-owl.min">Night Owl.Min</option>
    <option value="nnfx-dark">Nnfx Dark</option>
    <option value="nnfx-dark.min">Nnfx Dark.Min</option>
    <option value="nnfx-light">Nnfx Light</option>
    <option value="nnfx-light.min">Nnfx Light.Min</option>
    <option value="nord">Nord</option>
    <option value="nord.min">Nord.Min</option>
    <option value="obsidian">Obsidian</option>
    <option value="obsidian.min">Obsidian.Min</option>
    <option value="panda-syntax-dark">Panda Syntax Dark</option>
    <option value="panda-syntax-dark.min">Panda Syntax Dark.Min</option>
    <option value="panda-syntax-light">Panda Syntax Light</option>
    <option value="panda-syntax-light.min">Panda Syntax Light.Min</option>
    <option value="paraiso-dark">Paraiso Dark</option>
    <option value="paraiso-dark.min">Paraiso Dark.Min</option>
    <option value="paraiso-light">Paraiso Light</option>
    <option value="paraiso-light.min">Paraiso Light.Min</option>
    <option value="pojoaque">Pojoaque</option>
    <option value="pojoaque.min">Pojoaque.Min</option>
    <option value="purebasic">Purebasic</option>
    <option value="purebasic.min">Purebasic.Min</option>
    <option value="qtcreator-dark">Qtcreator Dark</option>
    <option value="qtcreator-dark.min">Qtcreator Dark.Min</option>
    <option value="qtcreator-light">Qtcreator Light</option>
    <option value="qtcreator-light.min">Qtcreator Light.Min</option>
    <option value="rainbow">Rainbow</option>
    <option value="rainbow.min">Rainbow.Min</option>
    <option value="routeros">Routeros</option>
    <option value="routeros.min">Routeros.Min</option>
    <option value="school-book">School Book</option>
    <option value="school-book.min">School Book.Min</option>
    <option value="shades-of-purple">Shades Of Purple</option>
    <option value="shades-of-purple.min">Shades Of Purple.Min</option>
    <option value="srcery">Srcery</option>
    <option value="srcery.min">Srcery.Min</option>
    <option value="stackoverflow-dark">Stackoverflow Dark</option>
    <option value="stackoverflow-dark.min">Stackoverflow Dark.Min</option>
    <option value="stackoverflow-light">Stackoverflow Light</option>
    <option value="stackoverflow-light.min">Stackoverflow Light.Min</option>
    <option value="sunburst">Sunburst</option>
    <option value="sunburst.min">Sunburst.Min</option>
    <option value="tokyo-night-dark">Tokyo Night Dark</option>
    <option value="tokyo-night-dark.min">Tokyo Night Dark.Min</option>
    <option value="tokyo-night-light">Tokyo Night Light</option>
    <option value="tokyo-night-light.min">Tokyo Night Light.Min</option>
    <option value="tomorrow-night-blue">Tomorrow Night Blue</option>
    <option value="tomorrow-night-blue.min">Tomorrow Night Blue.Min</option>
    <option value="tomorrow-night-bright">Tomorrow Night Bright</option>
    <option value="tomorrow-night-bright.min">Tomorrow Night Bright.Min</option>
    <option value="vs">Vs</option>
    <option value="vs.min">Vs.Min</option>
    <option value="vs2015">Vs2015</option>
    <option value="vs2015.min">Vs2015.Min</option>
    <option value="xcode">Xcode</option>
    <option value="xcode.min">Xcode.Min</option>
    <option value="xt256">Xt256</option>
    <option value="xt256.min">Xt256.Min</option>
  </select>

  <h1>–ê–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü—ñ—è —Ä–æ–±–æ—Ç–∏ –∑ Excel –∑–∞ –¥–æ–ø–æ–º–æ–≥–æ—é Python —Ç–∞ win32com.client</h1>

  <section id="1">
    <h2>1. –ü—ñ–¥–≥–æ—Ç–æ–≤–∫–∞ —Å–µ—Ä–µ–¥–æ–≤–∏—â–∞</h2>
    <p>–î–ª—è —Ä–æ–±–æ—Ç–∏ –∑ Excel —á–µ—Ä–µ–∑ Python –Ω–µ–æ–±—Ö—ñ–¥–Ω–æ –≤—Å—Ç–∞–Ω–æ–≤–∏—Ç–∏ –±—ñ–±–ª—ñ–æ—Ç–µ–∫—É pywin32:</p>
    <script>
      createCodeBlock(`pip install pywin32`, document.querySelector('[id="1"]'));
    </script>
    <p>–¢–∞–∫–æ–∂ —Å–ª—ñ–¥ –ø–µ—Ä–µ–∫–æ–Ω–∞—Ç–∏—Å—è, —â–æ –≤—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–π Microsoft Excel.</p>
  </section>

  <section id="2">
    <h2>2. –°—Ç–≤–æ—Ä–µ–Ω–Ω—è —Ç–∞ —Ä–µ–¥–∞–≥—É–≤–∞–Ω–Ω—è Excel-—Ñ–∞–π–ª—É</h2>

    <h3 id="2.1">2.1 –ü–µ—Ä–µ–≤—ñ—Ä–∫–∞ —ñ—Å–Ω—É–≤–∞–Ω–Ω—è —Ñ–∞–π–ª—É —Ç–∞ –π–æ–≥–æ –≤–∏–¥–∞–ª–µ–Ω–Ω—è</h3>
    <script>
      createCodeBlock(String.raw`
import win32com.client
import os

xlsx_filepath = r"C:\Users\dmytr\Desktop\xlsx-py\report.xlsx"
if os.path.exists(xlsx_filepath):
    print(f"–§–∞–π–ª –≤–∏–¥–∞–ª–µ–Ω–æ {xlsx_filepath}")
    os.remove(xlsx_filepath)
else:
    print(f"–ü–æ—á–∞—Ç–æ–∫ —Å—Ç–≤–æ—Ä–µ–Ω–Ω—è —Ñ–∞–π–ª—É {xlsx_filepath}")

`, document.querySelector('[id="2.1"]'));
    </script>

    <h3 id="2.2">2.2 –°—Ç–≤–æ—Ä–µ–Ω–Ω—è, –∑–±–µ—Ä–µ–∂–µ–Ω–Ω—è —Ñ–∞–π–ª—É —Ç–∞ –∑–∞–∫—Ä–∏—Ç—Ç—è
      <script>
        createCodeBlock(String.raw`
xlsx_filepath = r"C:\Users\dmytr\Desktop\xlsx-py\report.xlsx"

# –ó–∞–ø—É—Å–∫ Excel
excel = win32com.client.Dispatch("Excel.Application")

# –°—Ç–≤–æ—Ä–µ–Ω–Ω—è –Ω–æ–≤–æ–≥–æ —Ñ–∞–π–ª—É
wb = excel.Workbooks.Add()


# –ó–±–µ—Ä–µ–∂–µ–Ω–Ω—è —Ñ–∞–π–ª—É –≤ –∑–∞–∑–Ω–∞—á–µ–Ω—É –ø–∞–ø–∫—É
wb.SaveAs(xlsx_filepath)

# –ó–∞–∫—Ä–∏—Ç—Ç—è —Ñ–∞–π–ª—É —Ç–∞ –≤–∏—Ö—ñ–¥ –∑ Excel
wb.Close(SaveChanges=1)  # 1 –æ–∑–Ω–∞—á–∞—î –∑–±–µ—Ä–µ–≥—Ç–∏ –∑–º—ñ–Ω–∏
excel.Quit()
print(f"–ó–±–µ—Ä–µ–∂–µ–Ω–Ω—è —Ñ–∞–π–ª—É {xlsx_filepath}")


`, document.querySelector('[id="2.2"]'));
      </script>


    </h3>
    <div class="container">
      <figure>
          <img src="../images/pywin32_excel/2.2.png" alt="2.2 –°—Ç–≤–æ—Ä–µ–Ω–Ω—è, –∑–±–µ—Ä–µ–∂–µ–Ω–Ω—è —Ñ–∞–π–ª—É —Ç–∞ –∑–∞–∫—Ä–∏—Ç—Ç—è">
          <figcaption>–í–∏–≥–ª—è–¥ –¥–µ—Ñ–æ–ª—Ç–Ω–æ—ó –∫–Ω–∏–≥–∏</figcaption>
      </figure>
  </div>

    <h3 id="2.3">2.3 –î–æ–¥–∞–≤–∞–Ω–Ω—è —Ç–∞ –ø–µ—Ä–µ–π–º–µ–Ω—É–≤–∞–Ω–Ω—è –∞—Ä–∫—É—à—ñ–≤
      <script>
        createCodeBlock(String.raw`
# –î–æ–¥–∞–≤–∞–Ω–Ω—è —Ç–∞ –ø–µ—Ä–µ–π–º–µ–Ω—É–≤–∞–Ω–Ω—è –∞—Ä–∫—É—à–∞
ws1 = wb.Sheets.Add()
ws1.Name = "–õ–∏—Å—Ç1"
ws2 = wb.Sheets.Add()
ws2.Name = "–õ–∏—Å—Ç2"

`, document.querySelector('[id="2.3"]'));
      </script>
    </h3>


  
    <h3 id="2.4">2.4 –í—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—è –∞–∫—Ç–∏–≤–Ω–æ–≥–æ –∞—Ä–∫—É—à–∞</h3>
    <script>
      createCodeBlock(String.raw`
# –í—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—è –∞–∫—Ç–∏–≤–Ω–æ–≥–æ –∞—Ä–∫—É—à–∞
wb.Sheets("–õ–∏—Å—Ç2").Activate()

# –ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω–æ –∞–∫—Ç–∏–≤—É—î–º–æ –ø–µ—Ä—à–∏–π –∞—Ä–∫—É—à
wb.Sheets(1).Activate()

`, document.querySelector('[id="2.4"]'));
    </script>

    <h3 id="2.5">2.5 –ü–µ—Ä–µ–ª—ñ–∫ –≤—Å—ñ—Ö –∞—Ä–∫—É—à—ñ–≤</h3>
    <script>
      createCodeBlock(String.raw`
# –ü–µ—Ä–µ–ª—ñ–∫ –≤—Å—ñ—Ö –∞—Ä–∫—É—à—ñ–≤
sheets = wb.Sheets
for sheet in sheets:
    print(sheet.Index, sheet.Name)  # –í–∏–≤–µ–¥–µ –ø–æ–∑–∏—Ü—ñ—é —Ç–∞ —ñ–º'—è –∫–æ–∂–Ω–æ–≥–æ –∞—Ä–∫—É—à–∞

`, document.querySelector('[id="2.5"]'));
    </script>


    <h3 id="2.6">2.6 –í–∏–¥–∞–ª–µ–Ω–Ω—è –∞—Ä–∫—É—à–∞ –∑–∞ —ñ–º'—è–º</h3>
    <script>
      createCodeBlock(String.raw`
# –í–∏–¥–∞–ª—è—î–º–æ –∞—Ä–∫—É—à –∑–∞ —ñ–º'—è–º
sheet_name_to_delete = "–õ–∏—Å—Ç 3"

try:
    sheet_to_delete = sheets(sheet_name_to_delete)
    sheet_to_delete.Delete()
    print(f"–ê—Ä–∫—É—à '{sheet_name_to_delete}' –≤–∏–¥–∞–ª–µ–Ω–æ.")
except Exception as e:
    print(f"–ù–µ –≤–¥–∞–ª–æ—Å—è –≤–∏–¥–∞–ª–∏—Ç–∏ –∞—Ä–∫—É—à: {e}")


`, document.querySelector('[id="2.6"]'));
    </script>

    <h3 id="2.7">2.7 –ó–∞–ø–∏—Å –¥–∞–Ω–∏—Ö —É –∫–ª—ñ—Ç–∏–Ω–∫–∏</h3>
    <script>
      createCodeBlock(String.raw`
# –ó–∞–ø–∏—Å —Ç–µ–∫—Å—Ç—É –≤ –∫–ª—ñ—Ç–∏–Ω–∫—É
ws1.Cells(1, 1).Value = "–ü—Ä–∏–≤—ñ—Ç"

# –ó–∞–ø–∏—Å —á–∏—Å–ª–æ–≤–∏—Ö –∑–Ω–∞—á–µ–Ω—å
ws1.Cells(2, 1).Value = 100

# –ó–∞–ø–∏—Å —Ñ–æ—Ä–º—É–ª–∏
ws1.Cells(3, 1).Formula = "=SUM(A1:A2)"

# –ó–∞–ø–∏—Å –∑–Ω–∞—á–µ–Ω—å —É –¥—ñ–∞–ø–∞–∑–æ–Ω –∫–ª—ñ—Ç–∏–Ω–æ–∫
ws2.Range("A1:B2").Value = [[1, 2], [3, 4]]


# –ó–∞–ø–∏—Å –∑–Ω–∞—á–µ–Ω—å —É –¥—ñ–∞–ø–∞–∑–æ–Ω –∫–ª—ñ—Ç–∏–Ω–æ–∫
ws3 = wb.Sheets.Add()
ws3.Name = "–õ–∏—Å—Ç3"
for row in range(1, 11):
    for col in range(1, 6):
        ws3.Cells(row, col).Value = f"–ó–Ω–∞—á–µ–Ω–Ω—è {row},{col}"



# –î–∞–Ω—ñ
data = [
    ["Category", "Sales", "Region", "Date"],
    ["Apples", 100, "North", "2024-01-01"],
    ["Bananas", 200, "South", "2024-01-02"],
    ["Apples", 150, "West", "2024-01-02"],
    ["Bananas", 250, "North", "2024-01-03"],
    ["Oranges", 180, "East", "2024-01-04"],
    ["Apples", 300, "South", "2024-01-05"],
    ["Oranges", 220, "North", "2024-01-06"],
    ["Bananas", 180, "West", "2024-01-07"],
    ["Apples", 130, "East", "2024-01-08"],
    ["Oranges", 200, "South", "2024-01-09"],
]

# –ó–∞–ø–∏—Å –¥–∞–Ω–∏—Ö —É –≤—Ä–∫—É—à
for row_idx, row in enumerate(data, start=1):
    for col_idx, value in enumerate(row, start=1):
        sheet.Cells(row_idx, col_idx).Value = value

`, document.querySelector('[id="2.7"]'));
    </script>
    <div class="container">
      <figure>
          <img src="../images/pywin32_excel/2.7.png" alt="2.7 –ó–∞–ø–∏—Å –¥–∞–Ω–∏—Ö —É –∫–ª—ñ—Ç–∏–Ω–∫–∏">
          <figcaption>–†–µ–∑—É–ª—å—Ç–∞—Ç –∑–∞–ø–∏—Å—É –¥–∞–Ω–∏—Ö</figcaption>
      </figure>
  </div>


    <h3 id="2.8">2.8 –§–æ—Ä–º–∞—Ç—É–≤–∞–Ω–Ω—è –∫–ª—ñ—Ç–∏–Ω–æ–∫</h3>
    <script>
      createCodeBlock(String.raw`
# –ó–º—ñ–Ω–∞ —à—Ä–∏—Ñ—Ç—É —Ç–∞ —Å—Ç–∏–ª—é —Ç–µ–∫—Å—Ç—É
cell = ws1.Cells(1, 1)
cell.Font.Name = "Arial"
cell.Font.Size = 12
cell.Font.Bold = True
cell.Font.Color = 0xFF0000  # –ß–µ—Ä–≤–æ–Ω–∏–π
cell.Font.Italic = True
cell.Font.Underline = True  # –ü—ñ–¥–∫—Ä–µ—Å–ª–µ–Ω–Ω—è
cell.Font.Strikethrough = True  # –ó–∞–∫—Ä–µ—Å–ª–µ–Ω–∏–π —Ç–µ–∫—Å—Ç

# –ó–º—ñ–Ω–∞ –∫–æ–ª—å–æ—Ä—É —Ñ–æ–Ω—É
cell.Interior.Color = 0x00FF00  # –ó–µ–ª–µ–Ω–∏–π —Ñ–æ–Ω

# –î–æ–¥–∞–≤–∞–Ω–Ω—è –æ–±–≤–µ–¥–µ–Ω–Ω—è
cell.Borders(1).LineStyle = 1  # –õ—ñ–Ω—ñ—è –∑–ª—ñ–≤–∞ (xlEdgeLeft)
cell.Borders(2).LineStyle = 1  # –õ—ñ–Ω—ñ—è –≤–≥–æ—Ä—ñ (xlEdgeTop)
cell.Borders(3).LineStyle = 1  # –õ—ñ–Ω—ñ—è –∑–Ω–∏–∑—É (xlEdgeBottom)
cell.Borders(4).LineStyle = 1  # –õ—ñ–Ω—ñ—è –ø—Ä–∞–≤–æ—Ä—É—á (xlEdgeRight)

# –¢–æ–≤—Å—Ç–∞ —á–æ—Ä–Ω–∞ —Ä–∞–º–∫–∞ –Ω–∞–≤–∫–æ–ª–æ –∫–ª—ñ—Ç–∏–Ω–∫–∏
cell.Borders(7).Weight = 4  # xlThick
cell.Borders(7).Color = 0x000000  # –ß–æ—Ä–Ω–∏–π –∫–æ–ª—ñ—Ä

# –í–∏—Ä—ñ–≤–Ω—é–≤–∞–Ω–Ω—è —Ç–µ–∫—Å—Ç—É —É –∫–ª—ñ—Ç–∏–Ω—Ü—ñ
cell.HorizontalAlignment = -4108  # xlCenter
cell.VerticalAlignment = -4108  # xlCenter
cell.WrapText = True  # –ê–≤—Ç–æ–º–∞—Ç–∏—á–Ω–∏–π –ø–µ—Ä–µ–Ω–æ—Å —Ç–µ–∫—Å—Ç—É

# –§–æ—Ä–º–∞—Ç—É–≤–∞–Ω–Ω—è —á–∏—Å–µ–ª
ws1.Cells(2, 2).NumberFormat = "#,##0.00"  # –§–æ—Ä–º–∞—Ç –∑ –¥–≤–æ–º–∞ –¥–µ—Å—è—Ç–∫–æ–≤–∏–º–∏
ws1.Cells(3, 2).NumberFormat = "0%"  # –í—ñ–¥–æ–±—Ä–∞–∂–µ–Ω–Ω—è —É –≤—ñ–¥—Å–æ—Ç–∫–∞—Ö
ws1.Cells(4, 2).NumberFormat = "dd/mm/yyyy"  # –î–∞—Ç–∞ —É —Ñ–æ—Ä–º–∞—Ç—ñ –¥–µ–Ω—å/–º—ñ—Å—è—Ü—å/—Ä—ñ–∫

`, document.querySelector('[id="2.8"]'));
    </script>
  </section>

  <section id="3">
    <h2>3. –†–æ–±–æ—Ç–∞ –∑—ñ –∑–≤–µ–¥–µ–Ω–∏–º–∏ —Ç–∞–±–ª–∏—Ü—è–º–∏</h2>

    <h3 id="3.1">3.1 –°—Ç–≤–æ—Ä–µ–Ω–Ω—è –ø—Ä–æ—Å—Ç–æ—ó –∑–≤–µ–¥–µ–Ω–æ—ó —Ç–∞–±–ª–∏—Ü—ñ</h3>
    <script>
      createCodeBlock(String.raw`
pivot_sheet = wb.Sheets.Add()
pivot_sheet.Name = "–ó–≤–µ–¥–µ–Ω–∞ —Ç–∞–±–ª–∏—Ü—è"

# üìå –ü—Ä–∏–∫–ª–∞–¥ –≤–∏—Ö—ñ–¥–Ω–∏—Ö –¥–∞–Ω–∏—Ö
data = [
    ["–ö–∞—Ç–µ–≥–æ—Ä—ñ—è", "–ü—Ä–æ–¥–∞–∂—ñ"],
    ["–Ø–±–ª—É–∫–∞", 100],
    ["–ë–∞–Ω–∞–Ω–∏", 200],
    ["–Ø–±–ª—É–∫–∞", 150],
    ["–ë–∞–Ω–∞–Ω–∏", 250],
    ["–ê–ø–µ–ª—å—Å–∏–Ω–∏", 180],
]

# üìå –ó–∞–ø–∏—Å—É—î–º–æ –≤–∏—Ö—ñ–¥–Ω—ñ –¥–∞–Ω—ñ —É –Ω–æ–≤–∏–π –∞—Ä–∫—É—à
for row_idx, row in enumerate(data, start=1):
    for col_idx, value in enumerate(row, start=1):
        pivot_sheet.Cells(row_idx, col_idx).Value = value

# üìå –í–∏–∑–Ω–∞—á–∞—î–º–æ –¥—ñ–∞–ø–∞–∑–æ–Ω –¥–∞–Ω–∏—Ö
last_row = len(data)
data_range = pivot_sheet.Range(f"A1:B{last_row}")  # –ù–∞–ø—Ä–∏–∫–ª–∞–¥, A1:B6
pivot_table_range = pivot_sheet.Range("D1")  # –ü–æ—á–∞—Ç–∫–æ–≤–∞ –∫–æ–º—ñ—Ä–∫–∞ –¥–ª—è –∑–≤–µ–¥–µ–Ω–æ—ó —Ç–∞–±–ª–∏—Ü—ñ

# üìå –°—Ç–≤–æ—Ä—é—î–º–æ –∫–µ—à –¥–ª—è –∑–≤–µ–¥–µ–Ω–æ—ó —Ç–∞–±–ª–∏—Ü—ñ
pivot_cache = wb.PivotCaches().Create(SourceType=1, SourceData=data_range, Version=6)

# üìå –°—Ç–≤–æ—Ä—é—î–º–æ —Å–∞–º—É –∑–≤–µ–¥–µ–Ω—É —Ç–∞–±–ª–∏—Ü—é
pivot_table = pivot_cache.CreatePivotTable(TableDestination=pivot_table_range, TableName="SalesPivot")

# üìå –í—Å—Ç–∞–Ω–æ–≤–ª—é—î–º–æ –ø–æ–ª–µ —Ä—è–¥–∫—ñ–≤ (–ö–∞—Ç–µ–≥–æ—Ä—ñ—è)
pivot_table.PivotFields("–ö–∞—Ç–µ–≥–æ—Ä—ñ—è").Orientation = 1  # xlRowField

# üî• –î–æ–¥–∞—î–º–æ –ø–æ–ª–µ "–ü—Ä–æ–¥–∞–∂—ñ" —è–∫ –ø—ñ–¥—Å—É–º–∫–æ–≤–µ (—Å–ø–æ—á–∞—Ç–∫—É)
data_field = pivot_table.AddDataField(pivot_table.PivotFields("–ü—Ä–æ–¥–∞–∂—ñ"), "–ó–∞–≥–∞–ª—å–Ω—ñ –ø—Ä–æ–¥–∞–∂—ñ", -4157)  # xlSum

`, document.querySelector('[id="3.1"]'));
    </script>

<div class="container">
  <figure>
      <img src="../images/pywin32_excel/3.1.png" alt="3.1 –°—Ç–≤–æ—Ä–µ–Ω–Ω—è –ø—Ä–æ—Å—Ç–æ—ó –∑–≤–µ–¥–µ–Ω–æ—ó —Ç–∞–±–ª–∏—Ü—ñ">
      <figcaption>–ü—Ä–æ—Å—Ç–∞ –∑–≤–µ–¥–µ–Ω–∞ —Ç–∞–±–ª–∏—Ü—è</figcaption>
  </figure>
</div>


    <h3 id="3.2">3.2 –°—Ç–≤–æ—Ä–µ–Ω–Ω—è —Å–∫–ª–∞–¥–Ω–æ—ó –∑–≤–µ–¥–µ–Ω–æ—ó —Ç–∞–±–ª–∏—Ü—ñ</h3>
    <script>
      createCodeBlock(String.raw`
complex_pivot_sheet = wb.Sheets.Add()
complex_pivot_sheet.Name = "–°–∫–ª–∞–¥–Ω–∞ –∑–≤–µ–¥–µ–Ω–∞ —Ç–∞–±–ª–∏—Ü—è"

# üìå –ü—Ä–∏–∫–ª–∞–¥ –≤–∏—Ö—ñ–¥–Ω–∏—Ö –¥–∞–Ω–∏—Ö
data = [
    ["–ö–∞—Ç–µ–≥–æ—Ä—ñ—è", "–ü—Ä–æ–¥–∞–∂—ñ", "–†–µ–≥—ñ–æ–Ω", "–î–∞—Ç–∞"],
    ["–Ø–±–ª—É–∫–∞", 100, "–ü—ñ–≤–Ω—ñ—á", "2024-01-01"],
    ["–ë–∞–Ω–∞–Ω–∏", 200, "–ü—ñ–≤–¥–µ–Ω—å", "2024-01-02"],
    ["–Ø–±–ª—É–∫–∞", 150, "–ó–∞—Ö—ñ–¥", "2024-01-02"],
    ["–ë–∞–Ω–∞–Ω–∏", 250, "–ü—ñ–≤–Ω—ñ—á", "2024-01-03"],
    ["–ê–ø–µ–ª—å—Å–∏–Ω–∏", 180, "–°—Ö—ñ–¥", "2024-01-04"],
    ["–Ø–±–ª—É–∫–∞", 300, "–ü—ñ–≤–¥–µ–Ω—å", "2024-01-05"],
]

# üìå –ó–∞–ø–∏—Å—É—î–º–æ –≤–∏—Ö—ñ–¥–Ω—ñ –¥–∞–Ω—ñ —É –Ω–æ–≤–∏–π –∞—Ä–∫—É—à
for row_idx, row in enumerate(data, start=1):
    for col_idx, value in enumerate(row, start=1):
        complex_pivot_sheet.Cells(row_idx, col_idx).Value = value

# üìå –í–∏–∑–Ω–∞—á–∞—î–º–æ –¥—ñ–∞–ø–∞–∑–æ–Ω –¥–∞–Ω–∏—Ö
last_row = len(data)
last_col = len(data[0])
data_range = complex_pivot_sheet.Range(
    complex_pivot_sheet.Cells(1, 1), 
    complex_pivot_sheet.Cells(last_row, last_col)
)  # –î—ñ–∞–ø–∞–∑–æ–Ω A1:D11
pivot_table_range = complex_pivot_sheet.Range("F2")  # –ü–æ—á–∞—Ç–∫–æ–≤–∞ –∫–æ–º—ñ—Ä–∫–∞ –¥–ª—è –∑–≤–µ–¥–µ–Ω–æ—ó —Ç–∞–±–ª–∏—Ü—ñ

# üìå –°—Ç–≤–æ—Ä—é—î–º–æ –∫–µ—à –¥–ª—è –∑–≤–µ–¥–µ–Ω–æ—ó —Ç–∞–±–ª–∏—Ü—ñ
pivot_cache = wb.PivotCaches().Create(SourceType=1, SourceData=data_range, Version=6)

# üìå –°—Ç–≤–æ—Ä—é—î–º–æ —Å–∞–º—É –∑–≤–µ–¥–µ–Ω—É —Ç–∞–±–ª–∏—Ü—é
pivot_table = pivot_cache.CreatePivotTable(TableDestination=pivot_table_range, TableName="SalesPivot")

# üîπ –î–æ–¥–∞—î–º–æ –ø–æ–ª—è –¥–æ –∑–≤–µ–¥–µ–Ω–æ—ó —Ç–∞–±–ª–∏—Ü—ñ
pivot_table.PivotFields("–ö–∞—Ç–µ–≥–æ—Ä—ñ—è").Orientation = 1  # –ü–æ–ª–µ —Ä—è–¥–∫—ñ–≤ (xlRowField)
pivot_table.PivotFields("–†–µ–≥—ñ–æ–Ω").Orientation = 2    # –ü–æ–ª–µ —Å—Ç–æ–≤–ø—Ü—ñ–≤ (xlColumnField)
pivot_table.PivotFields("–î–∞—Ç–∞").Orientation = 3      # –ü–æ–ª–µ —Ñ—ñ–ª—å—Ç—Ä–∞ (xlPageField)

# üî• –î–æ–¥–∞—î–º–æ –ø–æ–ª–µ "–ü—Ä–æ–¥–∞–∂—ñ" —è–∫ –ø—ñ–¥—Å—É–º–∫–æ–≤–µ (—Å—É–º–∞)
data_field = pivot_table.AddDataField(pivot_table.PivotFields("–ü—Ä–æ–¥–∞–∂—ñ"), "–ó–∞–≥–∞–ª—å–Ω—ñ –ø—Ä–æ–¥–∞–∂—ñ", -4157)  # xlSum

# üîπ –§–æ—Ä–º–∞—Ç—É—î–º–æ –∑–Ω–∞—á–µ–Ω–Ω—è –ø—Ä–æ–¥–∞–∂—ñ–≤ (—Ä–æ–∑–¥—ñ–ª–µ–Ω–Ω—è —Ç–∏—Å—è—á)
data_field.NumberFormat = "#,##0"

`, document.querySelector('[id="3.2"]'));
    </script>
<div class="container">
  <figure>
      <img src="../images/pywin32_excel/3.2.png" alt="3.2 –°—Ç–≤–æ—Ä–µ–Ω–Ω—è —Å–∫–ª–∞–¥–Ω–æ—ó –∑–≤–µ–¥–µ–Ω–æ—ó —Ç–∞–±–ª–∏—Ü—ñ">
      <figcaption>–°–∫–ª–∞–¥–Ω–∞ –∑–≤–µ–¥–µ–Ω–∞ —Ç–∞–±–ª–∏—Ü—è</figcaption>
  </figure>
</div>

<h3 id="3.3">3.3 –°—Ç–≤–æ—Ä–µ–Ω–Ω—è —Å–∫–ª–∞–¥–Ω–æ—ó –∑–≤–µ–¥–µ–Ω–æ—ó —Ç–∞–±–ª–∏—Ü—ñ 2</h3>
<script>
  createCodeBlock(String.raw`
# üìå –î–æ–¥–∞—î–º–æ –¥–≤–∞ –Ω–æ–≤—ñ –∞—Ä–∫—É—à—ñ: –¥–ª—è –¥–∞–Ω–∏—Ö —Ç–∞ –¥–ª—è –∑–≤–µ–¥–µ–Ω–æ—ó —Ç–∞–±–ª–∏—Ü—ñ
complex_pivot_data_sheet2 = wb.Sheets.Add()
complex_pivot_data_sheet2.Name = "Data for Pivot Table 2"
complex_pivot_sheet2 = wb.Sheets.Add()
complex_pivot_sheet2.Name = "Complex Pivot Table 2"

# üìå –í—Ö—ñ–¥–Ω—ñ –¥–∞–Ω—ñ —É –≤–∏–≥–ª—è–¥—ñ —Å–ø–∏—Å–∫—É –∫–æ—Ä—Ç–µ–∂—ñ–≤
data = [
    ('id', 'name', 'age', 'value'),
    (1, "Alice", 25, 10),
    (2, "Bob", 30, 40),
    (3, "Charlie", 28, 20),
    (4, "David", 35, 30),
    (4, "David", 35, 100)
]

# üìå –ó–∞–ø–∏—Å—É—î–º–æ –¥–∞–Ω—ñ —É –Ω–æ–≤–∏–π –∞—Ä–∫—É—à
start_row = 1
start_col = 1

for row_idx, row in enumerate(data, start=start_row):
    for col_idx, value in enumerate(row, start=start_col):
        complex_pivot_data_sheet2.Cells(row_idx, col_idx).Value = value

# üìå –í–∏–∑–Ω–∞—á–∞—î–º–æ –¥—ñ–∞–ø–∞–∑–æ–Ω –¥–∞–Ω–∏—Ö –¥–ª—è –∑–≤–µ–¥–µ–Ω–æ—ó —Ç–∞–±–ª–∏—Ü—ñ (–≤–∫–ª—é—á–∞—é—á–∏ –∑–∞–≥–æ–ª–æ–≤–∫–∏)
last_row = len(data)  # –ö—ñ–ª—å–∫—ñ—Å—Ç—å —Ä—è–¥–∫—ñ–≤
last_col = len(data[0])  # –ö—ñ–ª—å–∫—ñ—Å—Ç—å –∫–æ–ª–æ–Ω–æ–∫
data_range = complex_pivot_data_sheet2.Range(
    complex_pivot_data_sheet2.Cells(1, 1), 
    complex_pivot_data_sheet2.Cells(last_row, last_col)
)

# üìå –°—Ç–≤–æ—Ä—é—î–º–æ –∫–µ—à –¥–ª—è –∑–≤–µ–¥–µ–Ω–æ—ó —Ç–∞–±–ª–∏—Ü—ñ
pivot_cache = wb.PivotCaches().Create(
    SourceType=1,  # 1 = xlDatabase
    SourceData=data_range,
    Version=6  # –î–ª—è –Ω–æ–≤–∏—Ö –≤–µ—Ä—Å—ñ–π Excel
)

# üìå –í–∏–∑–Ω–∞—á–∞—î–º–æ –º—ñ—Å—Ü–µ –¥–ª—è –≤—Å—Ç–∞–≤–∫–∏ –∑–≤–µ–¥–µ–Ω–æ—ó —Ç–∞–±–ª–∏—Ü—ñ
pivot_table_range = complex_pivot_sheet2.Range("A1")

# üìå –°—Ç–≤–æ—Ä—é—î–º–æ –∑–≤–µ–¥–µ–Ω—É —Ç–∞–±–ª–∏—Ü—é
pivot_table = pivot_cache.CreatePivotTable(
    TableDestination=pivot_table_range,  
    TableName="PivotTable2"
)

# üìå –û—Ç—Ä–∏–º—É—î–º–æ –æ–±'—î–∫—Ç –∑–≤–µ–¥–µ–Ω–æ—ó —Ç–∞–±–ª–∏—Ü—ñ
complex_pivot_sheet2.Select()
pivot = complex_pivot_sheet2.PivotTables("PivotTable2")

# üîπ –î–æ–¥–∞—î–º–æ –ø–æ–ª—è –¥–æ —Ä—è–¥–∫—ñ–≤
pivot.PivotFields("id").Orientation = 1  # xlRowField
pivot.PivotFields("name").Orientation = 1  # xlRowField
pivot.PivotFields("age").Orientation = 1  # xlRowField

# üìå –ó–º—ñ–Ω—é—î–º–æ –º–∞–∫–µ—Ç —Ä—è–¥–∫—ñ–≤ –Ω–∞ —Ç–∞–±–ª–∏—á–Ω–∏–π —Å—Ç–∏–ª—å
pivot_table.RowAxisLayout(RowLayout=1)

# üìå –í—ñ–¥–∫–ª—é—á–∞—î–º–æ –ø—ñ–¥—Å—É–º–∫–∏ –¥–ª—è –∫–æ–∂–Ω–æ–≥–æ –ø–æ–ª—è
for field_name in ["id", "name", "age"]:
    pivot_table.PivotFields(field_name).Subtotals = tuple(False for _ in range(12))

# üî• –î–æ–¥–∞—î–º–æ –ø–æ–ª–µ "value" —è–∫ –ø—ñ–¥—Å—É–º–∫–æ–≤–µ (—Å—É–º–∞)
data_field = pivot_table.AddDataField(pivot_table.PivotFields("value"), "Total Sales", -4157)  # xlSum


`, document.querySelector('[id="3.3"]'));
</script>

<div class="container">
  <figure>
      <img src="../images/pywin32_excel/3.3.png" alt="3.3 –°—Ç–≤–æ—Ä–µ–Ω–Ω—è —Å–∫–ª–∞–¥–Ω–æ—ó –∑–≤–µ–¥–µ–Ω–æ—ó —Ç–∞–±–ª–∏—Ü—ñ 2">
      <figcaption>–°–∫–ª–∞–¥–Ω–∞ –∑–≤–µ–¥–µ–Ω–∞ —Ç–∞–±–ª–∏—Ü—è 2</figcaption>
  </figure>
</div>

</body>

</html>